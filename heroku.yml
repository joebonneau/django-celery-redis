setup:
  addons:
    - plan: heroku-postgresql
      as: db
    - plan: heroku-redis
      as: redis
build:
  config:
    CELERY_BROKER_URL: "redis://redis:6379/0"
    CELERY_RESULT_BACKEND: "redis://redis:6379/0"
    DJANGO_DB: postgresql
    POSTGRES_HOST: db
    POSTGRES_NAME: postgres
    POSTGRES_USER: postgres
    POSTGRES_PASSWORD: postgres
    POSTGRES_PORT: 5432
  docker:
    web: ./backend.Dockerfile
    worker: ./backend.Dockerfile

run:
  web: sh server-entrypoint.sh
  worker: sh celery-entrypoint.sh
